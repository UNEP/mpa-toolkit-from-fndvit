@use "sass:math";
@use "sass:list" as *;
@use '../util.scss' as *;
@use './config.scss' as *;

@function _rem($font-size) {
  @return #{calc(strip-unit($font-size) / strip-unit($html-font-size))}rem;
}

@mixin _font-css($size, $weight, $line-height: null) {
  font-size: _rem($size);
  font-weight: $weight;
  @if $line-height != null {
    @if is-unit($line-height, 'px') {
      line-height: decimal-round(math.div($line-height, $size), 2);
    }
    @else if is-unit($line-height, '') {
      line-height: $line-height;
    }
  }
}

@function _get-font-style($font-name, $breakpoint: 'main') {
  @if not map-has-key($typography, $font-name) {
    @error "No font named " + $font-name;
  }
  $font-spec: map-get($typography, $font-name);
  $font-family: nth($font-spec, 1); // e.g. 'Montserrat'
  $font-style-map: nth($font-spec, 2); // e.g. ( main: 48 300, light: 24 300 )
  @if not map-has-key($font-style-map, $breakpoint) {
    @error $font-name + " has no " + $breakpoint + " breakpoint style";
  }
  @return (
    $font-family,
    map-get($font-style-map, $breakpoint)
  );
}

@mixin font($font-name, $breakpoint: main, $include-family: true) {
  $font-style: _get-font-style($font-name, $breakpoint);

  @if ($include-family) {
    font-family: nth($font-style, 1);
  }
  @include _font-css(nth($font-style, 2)...);

}
